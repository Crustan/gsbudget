function stripPriceUnit(t){if(void 0===t)return 0;var e=t.substr(0,t.length-3);return e}function getRows(t){for(var e=[],n=t.feed.entry,i=0;i<n.length;i++){var r={};n[i].title.$t.indexOf("V")!==-1?r.week=n[i].title.$t:$.inArray(n[i].title.$t,months)!==-1?r.month=n[i].title.$t:r.day=n[i].title.$t;for(var a=n[i].content.$t.split(","),s=0;s<a.length;s++){var l=a[s].split(":");r[l[0].trim()]=l[1].trim()}e.push(r)}return e}var orderOfGoogleSheet="1",googleSheetId="1_XEo5aynFAfSeXxXbs_6XbLa2XJ8hb3uXhNdXbkpbzI",googleSheetsApiLink="https://spreadsheets.google.com/feeds/list/"+googleSheetId+"/"+orderOfGoogleSheet+"/public/basic?alt=json",day=function(){var t=new Date;return t.getDate()},yesterday=function(){var t=new Date;return t.setDate(t.getDate()-1),t.getDate()},thisWeek=function(){var t=new Date;return t.setDate(t.getDate()-1),t.getWeekNumber()},months=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"];Date.prototype.getWeekNumber=function(){var t=new Date((+this));return t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7)),Math.ceil(((t-new Date(t.getFullYear(),0,1))/864e5+1)/7)},$(document).ready(function(){$.ajax(googleSheetsApiLink).then(function(t){for(var e=getRows(t),n=$.map(e,function(t){if(Number(t.day)===day())return t})[0],i=$.map(e,function(t){if(Number(t.day)===yesterday())return t})[0],r=$.map(e,function(t){if(t.week&&t.week.indexOf(thisWeek())!==-1)return t})[0],a=$.map(e,function(t){if(t.month)return t})[0],s=$(".area-unit"),l=0;l<s.length;l++){var o;$(s[l]).hasClass("bromma")?o="bromma":$(s[l]).hasClass("taby")?o="täby":$(s[l]).hasClass("hagersten")?o="hägersten":$(s[l]).hasClass("leveransbil")&&(o="leveransbil"),$(".total").find("label").text("Totalförsäljning "+a.month),$(".total").find("span.price").text(stripPriceUnit(a.totalförsäljning)),$(".total").find(".current span").text(a.totaltutfall),$(".total").find(".goal span.price").text(stripPriceUnit(a.totalbudget)),$(".total").find(".progress-indicator .fill-container").css("width",a.totaltutfall),$(s[l]).find(".month label").text("Försäljning "+a.month),$(s[l]).find(".week label").eq(0).text("Försäljning vecka "+thisWeek()),$(s[l]).find(".yesterday label").eq(0).text("Försäljning "+i.day+" "+a.month),$(s[l]).find(".day label").eq(0).text("Budget "+n.day+" "+a.month),$(s[l]).find(".new-customers span").text(a[o+"nyakunder"]),$(s[l]).find(".new-numbers span").text(a[o+"nummer"]),$(s[l]).find(".avarage-purchase span.price").text(stripPriceUnit(a[o+"snittköp"])),$(s[l]).find(".month span.price").text(stripPriceUnit(a[o+"försäljning"])),$(s[l]).find(".month .current span").text(a[o+"utfall"]),$(s[l]).find(".month .goal span.price").text(stripPriceUnit(a[o+"budget"])),$(s[l]).find(".month .progress-indicator .fill-container").css("width",a[o+"utfall"]),$(s[l]).find(".week article span.price").text(stripPriceUnit(r[o+"försäljning"])),$(s[l]).find(".week .till-1 span").text(r[o+"sälj"]),$(s[l]).find(".week .till-2 span").text(r[o+"bokningar"]),$(s[l]).find(".week .current span").text(r[o+"utfall"]),$(s[l]).find(".week .goal span.price").text(stripPriceUnit(r[o+"budget"])),$(s[l]).find(".week .progress-indicator .fill-container").css("width",r[o+"utfall"]),$(s[l]).find(".yesterday article span.price").text(stripPriceUnit(i[o+"försäljning"])),$(s[l]).find(".yesterday .till-1 span").text(i[o+"sälj"]),$(s[l]).find(".yesterday .till-2 span").text(i[o+"bokningar"]),$(s[l]).find(".yesterday .till-3 span.price").text(stripPriceUnit(i[o+"kassa1"])),$(s[l]).find(".yesterday .till-4 span.price").text(stripPriceUnit(i[o+"kassa2"])),$(s[l]).find(".day article span.price").text(stripPriceUnit(n[o+"budget"]))}})});