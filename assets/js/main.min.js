function stripPriceUnit(t){if(void 0===t)return 0;var e=t.substr(0,t.length-3);return e}function getRows(t){for(var e=[],n=t.feed.entry,r=0;r<n.length;r++){var i={};n[r].title.$t.indexOf("V")!==-1?i.week=n[r].title.$t:$.inArray(n[r].title.$t,months)!==-1?i.month=n[r].title.$t:i.day=n[r].title.$t;for(var a=n[r].content.$t.split(","),s=0;s<a.length;s++){var o=a[s].split(":");i[o[0].trim()]=o[1].trim()}e.push(i)}return e}function printThisMonth(){$.ajax(googleSheetsApiLink).then(function(t){var e=getRows(t),n=$.map(e,function(t){if(Number(t.day)===day())return t})[0];1!==day()&&(yesterdayRow=$.map(e,function(t){if(Number(t.day)===yesterday())return t})[0]);for(var r=$.map(e,function(t){if(t.week&&t.week.indexOf(thisWeek())!==-1)return t})[0],i=$.map(e,function(t){if(t.month)return t})[0],a=$(".area-unit"),s=0;s<a.length;s++){var o;$(a[s]).hasClass("bromma")?o="bromma":$(a[s]).hasClass("taby")?o="täby":$(a[s]).hasClass("hagersten")?o="hägersten":$(a[s]).hasClass("leveransbil")&&(o="leveransbil"),$(".total").find("label").text("Totalförsäljning "+i.month),$(".total").find("span.price").text(stripPriceUnit(i.totalförsäljning)),$(".total").find(".current span").text(i.totaltutfall),$(".total").find(".goal span.price").text(stripPriceUnit(i.totalbudget)),$(".total").find(".progress-indicator .fill-container").css("width",i.totaltutfall),$(a[s]).find(".month label").text("Försäljning "+i.month),$(a[s]).find(".new-customers span").text(i[o+"nyakunder"]),$(a[s]).find(".new-numbers span").text(i[o+"nummer"]),$(a[s]).find(".avarage-purchase span.price").text(stripPriceUnit(i[o+"snittköp"])),$(a[s]).find(".month span.price").text(stripPriceUnit(i[o+"försäljning"])),$(a[s]).find(".month .current span").text(i[o+"utfall"]),$(a[s]).find(".month .goal span.price").text(stripPriceUnit(i[o+"budget"])),$(a[s]).find(".month .progress-indicator .fill-container").css("width",i[o+"utfall"]),$(a[s]).find(".week label").eq(0).text("Försäljning vecka "+thisWeek()),$(a[s]).find(".week article span.price").text(stripPriceUnit(r[o+"försäljning"])),$(a[s]).find(".week .till-1 span").text(r[o+"säljomg"]),$(a[s]).find(".week .till-2 span").text(r[o+"bokningar"]),$(a[s]).find(".week .current span").text(r[o+"utfall"]),$(a[s]).find(".week .goal span.price").text(stripPriceUnit(r[o+"budget"])),$(a[s]).find(".week .progress-indicator .fill-container").css("width",r[o+"utfall"]),1===day()?$(a[s]).find(".yesterday label").eq(0).text("Försäljning "+yesterdayRow.day+" "+prevMonthRow.month):$(a[s]).find(".yesterday label").eq(0).text("Försäljning "+yesterdayRow.day+" "+i.month),$(a[s]).find(".yesterday article span.price").text(stripPriceUnit(yesterdayRow[o+"försäljning"])),$(a[s]).find(".yesterday .till-1 span").text(yesterdayRow[o+"säljomg"]),$(a[s]).find(".yesterday .till-2 span").text(yesterdayRow[o+"bokningar"]),$(a[s]).find(".yesterday .till-3 span.price").text(stripPriceUnit(yesterdayRow[o+"kassa1"])),$(a[s]).find(".yesterday .till-4 span.price").text(stripPriceUnit(yesterdayRow[o+"kassa2"])),$(a[s]).find(".day label").eq(0).text("Budget "+n.day+" "+i.month),$(a[s]).find(".day article span.price").text(stripPriceUnit(n[o+"budget"]))}})}var orderOfGoogleSheet="1",googleSheetId="1_XEo5aynFAfSeXxXbs_6XbLa2XJ8hb3uXhNdXbkpbzI",googleSheetsApiLink="https://spreadsheets.google.com/feeds/list/"+googleSheetId+"/"+orderOfGoogleSheet+"/public/basic?alt=json",day=function(){var t=new Date;return t.getDate()},yesterday=function(){var t=new Date;return t.setDate(t.getDate()-1),t.getDate()},yesterdayRow={},prevMonthRow={},thisWeek=function(){var t=new Date;return t.setDate(t.getDate()-1),t.getWeekNumber()},months=["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"];Date.prototype.getWeekNumber=function(){var t=new Date((+this));return t.setHours(0,0,0),t.setDate(t.getDate()+4-(t.getDay()||7)),Math.ceil(((t-new Date(t.getFullYear(),0,1))/864e5+1)/7)},$(document).ready(function(){if(1===day()){var t="https://spreadsheets.google.com/feeds/list/"+googleSheetId+"/2/public/basic?alt=json";$.ajax(t).then(function(t){var e=getRows(t);yesterdayRow=$.map(e,function(t){if(Number(t.day)===yesterday())return t})[0],prevMonthRow=$.map(e,function(t){if(t.month)return t})[0]}).then(printThisMonth)}else printThisMonth()});